{"ast":null,"code":"var _jsxFileName = \"D:\\\\untitled\\\\src\\\\component\\\\GetItem.js\";\nimport React, { Component } from \"react\";\nimport PubSub from \"pubsub-js\";\nimport Axios from \"axios\";\nimport qs from 'qs';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class GetItem extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      results: []\n    };\n\n    this.postitem = () => {\n      const data = {\n        q: 'owner:\"admin\" orgid:0123456789ABCDEF  ownerfolder:root -type:(\"Code Attachment\" OR \"Featured Items\") -typekeywords:(\"MapAreaPackage\") -type:(\"Map Area\")',\n        num: 20,\n        start: 1,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        f: \"json\",\n        token: this.state.tokenmanager\n      };\n      const params = qs.stringify(data);\n      Axios.post('https://p15v.arcgisonline.cn/portal/sharing/rest/search', params)\n      /*将获取到的数据提出，存储到state里*/\n      .then(res => {\n        const {\n          results\n        } = res.data;\n        this.setState({\n          results\n        });\n        /*     以下方法放弃\r\n         const arr = []\r\n                        this.state.results.map(obj => {\r\n                        1.创建一个数组arr，将id push进arr，然后在遍历的外侧写setsteate，就可以将对象id以数组的形式存入state\r\n                          const {id} = obj\r\n                            return (\r\n                                arr.push({id})\r\n                            )\r\n                         2.用get的请求获取图片，并存入arr中\r\n                            Axios.get('https://p15v.arcgisonline.cn/portal/sharing/rest/content/items/' + obj.id + '/info/thumbnail/Thumbnail.png', {params: {token: this.state.tokenmanager}})\r\n                                .then((res) => {\r\n                                    const {data}=res\r\n                                    arr.push({data})\r\n                                })\r\n                        })\r\n                        this.setState({arr})*/\n      });\n    };\n  }\n\n  componentDidMount() {\n    PubSub.subscribe('token', (msg, tokenmanager) => this.setState(tokenmanager)); //订阅Getinfo发布的token\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.postitem,\n        children: \"\\u83B7\\u53D6\\u9879\\u76EE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children:\n        /*利用.map遍历数组内的值*/\n        this.state.results.map(resultsobj => {\n          /*用获取到的id和token拼接一个url赋值给img标签*/\n          const imageurl = 'https://p15v.arcgisonline.cn/portal/sharing/rest/content/items/' + resultsobj.id + '/info/thumbnail/Thumbnail.png?token=' + this.state.tokenmanager;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"https://p15v.arcgisonline.cn/portal/home\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                alt: \"\",\n                src: imageurl\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 88\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: resultsobj.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 37\n            }, this)]\n          }, resultsobj.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 33\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["D:/untitled/src/component/GetItem.js"],"names":["React","Component","PubSub","Axios","qs","GetItem","state","results","postitem","data","q","num","start","sortField","sortOrder","f","token","tokenmanager","params","stringify","post","then","res","setState","componentDidMount","subscribe","msg","render","map","resultsobj","imageurl","id","title"],"mappings":";AAAA,OAAOA,KAAP,IAAcC,SAAd,QAA6B,OAA7B;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,EAAP,MAAe,IAAf;;AAEA,eAAe,MAAMC,OAAN,SAAsBJ,SAAtB,CAAgC;AAAA;AAAA;AAAA,SAC3CK,KAD2C,GACnC;AACJC,MAAAA,OAAO,EAAE;AADL,KADmC;;AAAA,SAS3CC,QAT2C,GAShC,MAAM;AAEb,YAAMC,IAAI,GAAG;AACTC,QAAAA,CAAC,EAAE,0JADM;AAETC,QAAAA,GAAG,EAAE,EAFI;AAGTC,QAAAA,KAAK,EAAE,CAHE;AAITC,QAAAA,SAAS,EAAE,UAJF;AAKTC,QAAAA,SAAS,EAAE,MALF;AAMTC,QAAAA,CAAC,EAAE,MANM;AAOTC,QAAAA,KAAK,EAAE,KAAKV,KAAL,CAAWW;AAPT,OAAb;AASA,YAAMC,MAAM,GAAGd,EAAE,CAACe,SAAH,CAAaV,IAAb,CAAf;AACAN,MAAAA,KAAK,CAACiB,IAAN,CAAW,yDAAX,EAAsEF,MAAtE;AACI;AADJ,OAEKG,IAFL,CAGSC,GAAD,IAAS;AACL,cAAM;AAACf,UAAAA;AAAD,YAAYe,GAAG,CAACb,IAAtB;AACA,aAAKc,QAAL,CAAc;AAAChB,UAAAA;AAAD,SAAd;AAEhB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACiB,OAvBT;AA2BH,KAhD0C;AAAA;;AAK3CiB,EAAAA,iBAAiB,GAAG;AAChBtB,IAAAA,MAAM,CAACuB,SAAP,CAAiB,OAAjB,EAA0B,CAACC,GAAD,EAAMT,YAAN,KAAuB,KAAKM,QAAL,CAAcN,YAAd,CAAjD,EADgB,CAC6D;AAChF;;AA2CDU,EAAAA,MAAM,GAAG;AAEL,wBAEI;AAAA,8BACI;AAAQ,QAAA,OAAO,EAAE,KAAKnB,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAA;AAGQ;AACA,aAAKF,KAAL,CAAWC,OAAX,CAAmBqB,GAAnB,CAAwBC,UAAD,IAAgB;AACnC;AACD,gBAAMC,QAAQ,GAAC,oEAAmED,UAAU,CAACE,EAA9E,GAAmF,sCAAnF,GAA0H,KAAKzB,KAAL,CAAWW,YAApJ;AACC,8BAEI;AAAA,oCACI;AAAG,cAAA,IAAI,EAAC,0CAAR;AAAA,qCAAmD;AAAK,gBAAA,GAAG,EAAC,EAAT;AACnD,gBAAA,GAAG,EAAEa;AAD8C;AAAA;AAAA;AAAA;AAAA;AAAnD;AAAA;AAAA;AAAA;AAAA,oBADJ,eAGI;AAAA,wBAAID,UAAU,CAACG;AAAf;AAAA;AAAA;AAAA;AAAA,oBAHJ;AAAA,aAAUH,UAAU,CAACE,EAArB;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAQH,SAXD;AAJR;AAAA;AAAA;AAAA;AAAA,cAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAFJ;AA0BH;;AA9E0C","sourcesContent":["import React,{Component}from \"react\"\r\nimport PubSub from \"pubsub-js\";\r\nimport Axios from \"axios\";\r\nimport qs from 'qs'\r\n\r\nexport default class GetItem extends Component {\r\n    state = {\r\n        results: [],\r\n    }\r\n\r\n    componentDidMount() {\r\n        PubSub.subscribe('token', (msg, tokenmanager) => this.setState(tokenmanager))//订阅Getinfo发布的token\r\n    }\r\n\r\n    postitem = () => {\r\n\r\n        const data = {\r\n            q: 'owner:\"admin\" orgid:0123456789ABCDEF  ownerfolder:root -type:(\"Code Attachment\" OR \"Featured Items\") -typekeywords:(\"MapAreaPackage\") -type:(\"Map Area\")',\r\n            num: 20,\r\n            start: 1,\r\n            sortField: \"modified\",\r\n            sortOrder: \"desc\",\r\n            f: \"json\",\r\n            token: this.state.tokenmanager\r\n        }\r\n        const params = qs.stringify(data);\r\n        Axios.post('https://p15v.arcgisonline.cn/portal/sharing/rest/search', params)\r\n            /*将获取到的数据提出，存储到state里*/\r\n            .then(\r\n                (res) => {\r\n                    const {results} = res.data\r\n                    this.setState({results})\r\n\r\n    /*     以下方法放弃\r\n     const arr = []\r\n                    this.state.results.map(obj => {\r\n                    1.创建一个数组arr，将id push进arr，然后在遍历的外侧写setsteate，就可以将对象id以数组的形式存入state\r\n                      const {id} = obj\r\n                        return (\r\n                            arr.push({id})\r\n                        )\r\n                     2.用get的请求获取图片，并存入arr中\r\n                        Axios.get('https://p15v.arcgisonline.cn/portal/sharing/rest/content/items/' + obj.id + '/info/thumbnail/Thumbnail.png', {params: {token: this.state.tokenmanager}})\r\n                            .then((res) => {\r\n                                const {data}=res\r\n                                arr.push({data})\r\n                            })\r\n                    })\r\n                    this.setState({arr})*/\r\n                }\r\n            )\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n\r\n            <div>\r\n                <button onClick={this.postitem}>获取项目</button>\r\n                <div>\r\n                    {\r\n\r\n                        /*利用.map遍历数组内的值*/\r\n                        this.state.results.map((resultsobj) => {\r\n                            /*用获取到的id和token拼接一个url赋值给img标签*/\r\n                           const imageurl='https://p15v.arcgisonline.cn/portal/sharing/rest/content/items/'+ resultsobj.id + '/info/thumbnail/Thumbnail.png?token='+this.state.tokenmanager\r\n                            return (\r\n\r\n                                <div key={resultsobj.id}>\r\n                                    <a href=\"https://p15v.arcgisonline.cn/portal/home\"><img alt=\"\"\r\n                                    src={imageurl}/></a>\r\n                                    <p>{resultsobj.title}</p>\r\n                                </div>\r\n                            )\r\n                        })\r\n\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}